<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="SYS_USER_ROLE" >
  <resultMap id="abatorgenerated_SysUserRoleResult" class="com.synesoft.fisp.domain.model.SysUserRole" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Fri Dec 20 11:00:07 CST 2013.
    -->
    <result column="ROLEID" property="roleid" jdbcType="CHAR" />
    <result column="USERID" property="userid" jdbcType="CHAR" />
    <result column="USERNAME" property="username" jdbcType="VARCHAR" />
    <result column="ROLENAME" property="rolename" jdbcType="VARCHAR" />
    <result column="OPTSTATUS" property="optstatus" jdbcType="CHAR" />
    <result column="CREATER" property="creater" jdbcType="VARCHAR" />
    <result column="CREATETIME" property="createtime" jdbcType="CHAR" />
    <result column="LASTOPERATOR" property="lastoperator" jdbcType="VARCHAR" />
    <result column="LASTOPTTIME" property="lastopttime" jdbcType="CHAR" />
    <result column="CHECKER" property="checker" jdbcType="VARCHAR" />
    <result column="CHECKTIME" property="checktime" jdbcType="CHAR" />
    <result column="RSV1" property="rsv1" jdbcType="VARCHAR" />
    <result column="RSV2" property="rsv2" jdbcType="VARCHAR" />
    <result column="RSV3" property="rsv3" jdbcType="VARCHAR" />
    <result column="RSV4" property="rsv4" jdbcType="VARCHAR" />
    <result column="RSV5" property="rsv5" jdbcType="VARCHAR" />
  </resultMap>
  
  <resultMap id="SysUserRoleMergeResult" class="com.synesoft.fisp.domain.model.SysUserRoleTmp" >
    <result column="ID" property="id" jdbcType="CHAR" />
    <result column="ROLEID" property="roleid" jdbcType="CHAR" />
    <result column="USERID" property="userid" jdbcType="CHAR" />
    <result column="USERNAME" property="username" jdbcType="VARCHAR" />
    <result column="ROLENAME" property="rolename" jdbcType="VARCHAR" />
    <result column="OPTTYPE" property="opttype" jdbcType="CHAR" />
    <result column="CREATER" property="creater" jdbcType="VARCHAR" />
    <result column="CREATETIME" property="createtime" jdbcType="CHAR" />
  </resultMap>

  <select id="selectByPrimaryKey" parameterClass="com.synesoft.fisp.domain.model.SysUserRole" 
  		resultMap="abatorgenerated_SysUserRoleResult">
    select 
    	*
    from 
    	SYS_USER_ROLE
    where 
    	trim(USERID) = #userid:CHAR# AND
    	trim(ROLEID) = #roleid:CHAR#
  </select>
  <select id="selectList" parameterClass="com.synesoft.fisp.domain.model.SysUserRole" 
  		resultMap="abatorgenerated_SysUserRoleResult">
	select 
		* 
	from 
		SYS_USER_ROLE  
	<dynamic prepend="WHERE">
		 <isNotEmpty prepend="AND" property="optstatus">
			TRIM(OPTSTATUS) = #optstatus:CHAR#
		</isNotEmpty>
	    <isNotEmpty prepend="and" property="userid">
			trim(USERID) = #userid:CHAR#
		</isNotEmpty>
		<isNotEmpty prepend="and" property="roleid">
			trim(ROLEID) = #roleid:CHAR#
		</isNotEmpty>
	</dynamic>
  </select>
  <select id="selectCounts" parameterClass="com.synesoft.fisp.domain.model.SysUserRole" 
  		resultClass="java.lang.Integer">
  	select 
		COUNT(*) 
	from 
		SYS_USER_ROLE  
	<dynamic prepend="WHERE">
		 <isNotEmpty prepend="AND" property="optstatus">
			TRIM(OPTSTATUS) = #optstatus:CHAR#
		</isNotEmpty>
	    <isNotEmpty prepend="and" property="userid">
			trim(USERID) = #userid:CHAR#
		</isNotEmpty>
		<isNotEmpty prepend="and" property="roleid">
			trim(ROLEID) = #roleid:CHAR#
		</isNotEmpty>
	</dynamic>
  </select>
  <select id="selectNotInList" parameterClass="com.synesoft.fisp.domain.model.SysUserRole" 
  		resultMap="abatorgenerated_SysUserRoleResult">
    select 
    	*
    from 
    	SYS_USER_ROLE
    where 
    	trim(USERID) = #userid:CHAR# AND
    	<iterate open="TRIM(ROLEID) NOT IN (" close=")" conjunction=",">
        	TRIM(#userRoleList[]#)
        </iterate>
  </select>
  <select id="selectMergeList" parameterClass="com.synesoft.fisp.domain.model.SysUserRoleTmp" 
  		resultMap="SysUserRoleMergeResult">
        SELECT 
	    	NULL ID, ROLEID, USERID, USERNAME, ROLENAME, '02' OPTTYPE, CREATER, CREATETIME
	    FROM 
	    	SYS_USER_ROLE
	    WHERE 
	    	TRIM(USERID) = #userid:CHAR# AND
	    	TRIM(ROLEID) NOT IN (SELECT TRIM(ROLEID) FROM SYS_USER_ROLE_TMP WHERE TRIM(USERID) = #userid:CHAR# AND OPTSTATUS = #optstatus:CHAR#)
    UNION
    	SELECT 
	    	ID, ROLEID, USERID, USERNAME, ROLENAME, OPTTYPE, CREATER, CREATETIME
	    FROM 
	    	SYS_USER_ROLE_TMP
	    WHERE 
	    	TRIM(USERID) = #userid:CHAR#  AND
	    	OPTSTATUS = #optstatus:CHAR#
  </select>
  <insert id="insert" parameterClass="com.synesoft.fisp.domain.model.SysUserRole" >
    insert into SYS_USER_ROLE (ROLEID, USERID, USERNAME, ROLENAME, OPTSTATUS, CREATER, 
      CREATETIME, LASTOPERATOR, LASTOPTTIME, CHECKER, CHECKTIME, RSV1, RSV2, RSV3, RSV4, RSV5)
    values (#roleid:CHAR#, #userid:CHAR#, #username:VARCHAR#, #rolename:VARCHAR#, #optstatus:CHAR#,
      #creater:VARCHAR#, #createtime:CHAR#, #lastoperator:VARCHAR#, #lastopttime:CHAR#,
      #checker:VARCHAR#, #checktime:CHAR#, #rsv1:VARCHAR#, #rsv2:VARCHAR#, #rsv3:VARCHAR#,
      #rsv4:VARCHAR#, #rsv5:VARCHAR#)
  </insert>
  
  <delete id="deleteByPrimaryKey" parameterClass="com.synesoft.fisp.domain.model.SysUserRole">
    DELETE FROM 
    	SYS_USER_ROLE
    WHERE 
   	  TRIM(ROLEID) = #roleid:CHAR# AND
      TRIM(USERID) = #userid:CHAR#
  </delete>
  
  <update id="updateByPrimaryKeySelective" parameterClass="com.synesoft.fisp.domain.model.SysUserRole">
    UPDATE SYS_USER_ROLE
    <dynamic prepend="set">
      <isNotNull prepend="," property="username">
        USERNAME = #username:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="rolename">
        ROLENAME = #rolename:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="optstatus">
        OPTSTATUS = #optstatus:CHAR#
      </isNotNull>
      <isNotNull prepend="," property="creater">
        CREATER = #creater:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="createtime">
        CREATETIME = #createtime:CHAR#
      </isNotNull>
      <isNotNull prepend="," property="lastoperator">
        LASTOPERATOR = #lastoperator:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="lastopttime">
        LASTOPTTIME = #lastopttime:CHAR#
      </isNotNull>
      <isNotNull prepend="," property="checker">
        CHECKER = #checker:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="checktime">
        CHECKTIME = #checktime:CHAR#
      </isNotNull>
      <isNotNull prepend="," property="rsv1">
        RSV1 = #rsv1:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="rsv2">
        RSV2 = #rsv2:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="rsv3">
        RSV3 = #rsv3:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="rsv4">
        RSV4 = #rsv4:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="rsv5">
        RSV5 = #rsv5:VARCHAR#
      </isNotNull>
    </dynamic>
    WHERE
      TRIM(ROLEID) = #roleid:CHAR# AND
      TRIM(USERID) = #userid:CHAR#
  </update>
</sqlMap>