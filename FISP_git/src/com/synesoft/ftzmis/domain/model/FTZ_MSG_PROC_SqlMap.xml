<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="FTZ_MSG_PROC" >
  <resultMap id="FtzMsgProcResult" class="com.synesoft.ftzmis.domain.model.FtzMsgProc" >
    <!--
      WARNING - This element is automatically generated by Abator for iBATIS, do not modify.
      This element was generated on Thu Feb 13 11:16:17 CST 2014.
    -->
    <result column="ID" property="id" jdbcType="DECIMAL" />
    <result column="VER" property="ver" jdbcType="VARCHAR" />
    <result column="SRC" property="src" jdbcType="VARCHAR" />
    <result column="DES" property="des" jdbcType="VARCHAR" />
    <result column="APP" property="app" jdbcType="VARCHAR" />
    <result column="MSG_NO" property="msgNo" jdbcType="VARCHAR" />
    <result column="MSG_ID" property="msgId" jdbcType="VARCHAR" />
    <result column="MSG_REF" property="msgRef" jdbcType="VARCHAR" />
    <result column="WORK_DATE" property="workDate" jdbcType="VARCHAR" />
    <result column="EDIT_FLAG" property="editFlag" jdbcType="VARCHAR" />
    <result column="RESERVE" property="reserve" jdbcType="VARCHAR" />
    <result column="MSG_DIRECTION" property="msgDirection" jdbcType="VARCHAR" />
    <result column="MSG_STATUS" property="msgStatus" jdbcType="VARCHAR" />
    <result column="FILE_NAME" property="fileName" jdbcType="VARCHAR" />
    <result column="SEND_TIME" property="sendTime" jdbcType="VARCHAR" />
    <result column="RECEIVE_TIME" property="receiveTime" jdbcType="VARCHAR" />
    <result column="COMM_REPLY_TIME" property="commReplyTime" jdbcType="VARCHAR" />
    <result column="PROC_REPLY_TIME" property="procReplyTime" jdbcType="VARCHAR" />
    <result column="APP_PROC_TIME" property="appProcTime" jdbcType="VARCHAR" />
    <result column="APP_PROC_COUNT" property="appProcCount" jdbcType="DECIMAL" />
    <result column="FAIL_REASON" property="failReason" jdbcType="VARCHAR" />
    <result column="RSV1" property="rsv1" jdbcType="VARCHAR" />
    <result column="RSV2" property="rsv2" jdbcType="VARCHAR" />
    <result column="RSV3" property="rsv3" jdbcType="VARCHAR" />
  </resultMap>

	<select id="selectByPrimaryKey" resultMap="FtzMsgProcResult" parameterClass="com.synesoft.ftzmis.domain.model.FtzMsgProc">
		select ID, VER, SRC, DES, APP, MSG_NO, MSG_ID, MSG_REF, WORK_DATE, EDIT_FLAG, RESERVE,
		MSG_DIRECTION, MSG_STATUS, FILE_NAME, SEND_TIME, RECEIVE_TIME, COMM_REPLY_TIME, 
		PROC_REPLY_TIME, APP_PROC_TIME, APP_PROC_COUNT, FAIL_REASON, RSV1, RSV2, RSV3
		from FTZ_MSG_PROC 
		where 1=1
		<dynamic>
			<isNotEmpty prepend="and" property="id">
				ID = #id:VARCHAR#
			</isNotEmpty>
			<isNotEmpty prepend="and" property="msgId">
				MSG_ID = #msgId:VARCHAR#
	      		</isNotEmpty>
			<isNotEmpty prepend="and" property="workDate">
				WORK_DATE = #workDate:VARCHAR#
	      		</isNotEmpty>
		</dynamic>
	</select>

	<select id="selectPendingMsg" resultMap="FtzMsgProcResult" parameterClass="java.lang.Integer">
		select ID, VER, SRC, DES, APP, MSG_NO, MSG_ID, MSG_REF, WORK_DATE, EDIT_FLAG, RESERVE,
		MSG_DIRECTION, MSG_STATUS, FILE_NAME, SEND_TIME, RECEIVE_TIME, COMM_REPLY_TIME, PROC_REPLY_TIME,
		APP_PROC_TIME, NVL(APP_PROC_COUNT, 0) AS APP_PROC_COUNT, FAIL_REASON, RSV1, RSV2, RSV3
		from FTZ_MSG_PROC
		where MSG_STATUS IN ('10','12','15','21','22') AND <![CDATA[NVL(APP_PROC_COUNT,0) < #value:DECIMAL#]]>
	</select>

	<insert id="insert" parameterClass="com.synesoft.ftzmis.domain.model.FtzMsgProc">
		insert into FTZ_MSG_PROC (ID, VER, SRC, DES, APP, MSG_NO, MSG_ID, MSG_REF, WORK_DATE, 
		EDIT_FLAG, RESERVE, MSG_DIRECTION, MSG_STATUS, FILE_NAME, SEND_TIME, RECEIVE_TIME, 
		COMM_REPLY_TIME, PROC_REPLY_TIME, APP_PROC_TIME, APP_PROC_COUNT, FAIL_REASON, RSV1, RSV2, RSV3)
		values
		(FTZ_MSG_PROC_SEQ.NEXTVAL, #ver:VARCHAR#, #src:VARCHAR#, #des:VARCHAR#, #app:VARCHAR#,
		#msgNo:VARCHAR#, #msgId:VARCHAR#, #msgRef:VARCHAR#, #workDate:VARCHAR#, #editFlag:VARCHAR#,
		#msgDirection:VARCHAR#, #msgStatus:VARCHAR#, #fileName:VARCHAR#,
		#sendTime:VARCHAR#, #receiveTime:VARCHAR#, #commReplyTime:VARCHAR#,
		#procReplyTime:VARCHAR#, #appProcTime:VARCHAR#, #appProcCount:DECIMAL#,
		#failReason:VARCHAR#, #rsv1:VARCHAR#, #rsv2:VARCHAR#, #rsv3:VARCHAR#)
	</insert>

	<update id="updateByPrimaryKeySelective">
		update FTZ_MSG_PROC
		<dynamic prepend="set">
			<isNotNull prepend="," property="id">
				ID = #id:DECIMAL#
			</isNotNull>
			<isNotNull prepend="," property="ver">
				VER = #ver:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="src">
				SRC = #src:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="des">
				DES = #des:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="app">
				APP = #app:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="msgNo">
				MSG_NO = #msgNo:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="msgId">
				MSG_ID = #msgId:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="msgRef">
				MSG_REF = #msgRef:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="workDate">
				WORK_DATE = #workDate:VARCHAR#
      		</isNotNull>
      		<isNotNull prepend="," property="editFlag">
				EDIT_FLAG = #editFlag:VARCHAR#
      		</isNotNull>
      		<isNotNull prepend="," property="reserve">
				RESERVE = #reserve:VARCHAR#
      		</isNotNull>
			<isNotNull prepend="," property="msgDirection">
				MSG_DIRECTION = #msgDirection:VARCHAR#
      		</isNotNull>
			<isNotNull prepend="," property="msgStatus">
				MSG_STATUS = #msgStatus:VARCHAR#
      		</isNotNull>
			<isNotNull prepend="," property="fileName">
				FILE_NAME = #fileName:VARCHAR#
      		</isNotNull>
			<isNotNull prepend="," property="sendTime">
				SEND_TIME = #sendTime:VARCHAR#
      		</isNotNull>
			<isNotNull prepend="," property="receiveTime">
				RECEIVE_TIME = #receiveTime:VARCHAR#
      		</isNotNull>
			<isNotNull prepend="," property="commReplyTime">
				COMM_REPLY_TIME = #commReplyTime:VARCHAR#
      		</isNotNull>
			<isNotNull prepend="," property="procReplyTime">
				PROC_REPLY_TIME = #procReplyTime:VARCHAR#
      		</isNotNull>
			<isNotNull prepend="," property="appProcTime">
				APP_PROC_TIME = #appProcTime:VARCHAR#
      		</isNotNull>
			<isNotNull prepend="," property="appProcCount">
				APP_PROC_COUNT = #appProcCount:DECIMAL#
      		</isNotNull>
			<isNotNull prepend="," property="failReason">
				FAIL_REASON = #failReason:VARCHAR#
      		</isNotNull>
			<isNotNull prepend="," property="rsv1">
				RSV1 = #rsv1:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="rsv2">
				RSV2 = #rsv2:VARCHAR#
			</isNotNull>
			<isNotNull prepend="," property="rsv3">
				RSV3 = #rsv3:VARCHAR#
			</isNotNull>
			where 1=1
			<isNotNull prepend="and" property="id">
				ID = #id:DECIMAL#
			</isNotNull>
			<isNotNull prepend="and" property="msgId">
				MSG_ID = #msgId:VARCHAR#
			</isNotNull>
			<isNotNull prepend="and" property="workDate">
				WORK_DATE = #workDate:VARCHAR#
      		</isNotNull>
		</dynamic>
	</update>
</sqlMap>